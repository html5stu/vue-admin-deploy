import{g as V,i as b,j as k,k as C,h as p,l as R,m as U,r as u,a as q,o as L,b as d,e as s,w as n,n as M,f as T,p as B,E,_ as F}from"./index-B9wvQeQm.js";const K={class:"login-container"},N={class:"login-box"},S={class:"flex w-full gap-2"},H=["innerHTML"],j=V({__name:"login",setup(z){const _=b(),v=k(),w=C(),c=p(),i=p(!1),m=p(""),o=R({username:"",password:"",code:"",uuid:""}),h={username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}]},f=async()=>{try{const r=await B();o.uuid=r.data.uuid,m.value=r.data.img,o.code=""}catch(r){console.error(r)}},g=()=>{console.log("1. 点击了登录按钮"),c.value&&c.value.validate(async(r,e)=>{if(r){i.value=!0;try{await w.login(o),console.log("3. 登录接口调用成功，Token已保存"),E.success("登录成功");const t=v.query.redirect||"/";_.push(t)}catch(l){console.error("登录失败:",l)}finally{i.value=!1}}else return console.log("表单校验失败:",e),!1})};return U(()=>{f()}),(r,e)=>{const l=u("el-input"),t=u("el-form-item"),y=u("el-button"),x=u("el-form");return L(),q("div",K,[d("div",N,[e[4]||(e[4]=d("h2",{class:"title"},"后台管理系统",-1)),s(x,{ref_key:"loginFormRef",ref:c,model:o,rules:h,size:"large"},{default:n(()=>[s(t,{prop:"username"},{default:n(()=>[s(l,{modelValue:o.username,"onUpdate:modelValue":e[0]||(e[0]=a=>o.username=a),placeholder:"请输入账号","prefix-icon":"User"},null,8,["modelValue"])]),_:1}),s(t,{prop:"password"},{default:n(()=>[s(l,{modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=a=>o.password=a),placeholder:"请输入密码","prefix-icon":"Lock",type:"password","show-password":""},null,8,["modelValue"])]),_:1}),s(t,{prop:"code"},{default:n(()=>[d("div",S,[s(l,{modelValue:o.code,"onUpdate:modelValue":e[2]||(e[2]=a=>o.code=a),placeholder:"验证码","prefix-icon":"Key",class:"flex-1",onKeyup:M(g,["enter"])},null,8,["modelValue"]),d("div",{class:"captcha-box cursor-pointer",innerHTML:m.value,onClick:f,title:"点击刷新"},null,8,H)])]),_:1}),s(y,{type:"primary",class:"w-full mt-4",loading:i.value,onClick:g},{default:n(()=>[...e[3]||(e[3]=[T(" 登 陆 ",-1)])]),_:1},8,["loading"])]),_:1},8,["model"])])])}}}),A=F(j,[["__scopeId","data-v-505cd4a9"]]);export{A as default};
