import{L as H,g as J,h as g,l as W,m as X,r as i,z as Y,a as k,o as c,b,e,w as l,n as U,f as n,A as Z,s as V,t as p,v as ee,F as q,E as j,_ as le}from"./index-B9wvQeQm.js";function te(x){return H({url:"/operlog/list",method:"get",params:x})}const ae={class:"p-6"},oe={class:"bg-white p-4 rounded-lg shadow-sm mb-4"},ne={class:"mb-0"},se={class:"bg-white p-4 rounded-lg shadow-sm"},re={class:"mt-4 flex justify-end"},de={class:"code-box"},ie={class:"code-box"},pe={key:0},ue={key:1,style:{color:"red"}},_e=J({name:"OperLogs",__name:"operlogs",setup(x){const h=g(!0),v=g([]),N=g(0),z=g([]),y=g(!1),r=g({}),o=W({pageNum:1,pageSize:10,title:void 0,operName:void 0,status:void 0}),E={0:{label:"其他",type:"info"},1:{label:"新增",type:""},2:{label:"修改",type:"warning"},3:{label:"删除",type:"danger"},4:{label:"授权",type:"success"},5:{label:"导出",type:"warning"},6:{label:"导入",type:"warning"}},S=s=>E[s]||{label:"未知",type:"info"},M=s=>s?new Date(s).toLocaleString():"",w=async()=>{h.value=!0;try{const s=await te(o);z.value=s.data.list,N.value=s.data.total}finally{h.value=!1}},m=()=>{o.pageNum=1,w()},O=()=>{o.title=void 0,o.operName=void 0,o.status=void 0,m()},T=s=>{v.value=s.map(t=>t.oper_id)},I=s=>{y.value=!0,r.value=s},K=()=>{const s=v.value.join(",");q.confirm("是否确认删除选中的日志数据项?","警告",{type:"warning"}).then(async()=>{await delOperLog(s),j.success("删除成功"),w(),v.value=[]})},P=()=>{q.confirm("是否确认清空所有操作日志数据项?","警告",{type:"warning"}).then(async()=>{await cleanOperLog(),j.success("清空成功"),w()})};return X(()=>{w()}),(s,t)=>{const L=i("el-input"),d=i("el-form-item"),D=i("el-option"),Q=i("el-select"),f=i("el-button"),B=i("el-form"),u=i("el-table-column"),C=i("el-tag"),R=i("el-table"),$=i("el-pagination"),_=i("el-col"),A=i("el-row"),F=i("el-dialog"),G=Y("loading");return c(),k("div",ae,[b("div",oe,[e(B,{model:o,ref:"queryRef",inline:!0},{default:l(()=>[e(d,{label:"系统模块",prop:"title"},{default:l(()=>[e(L,{modelValue:o.title,"onUpdate:modelValue":t[0]||(t[0]=a=>o.title=a),placeholder:"请输入模块标题",clearable:"",onKeyup:U(m,["enter"])},null,8,["modelValue"])]),_:1}),e(d,{label:"操作人员",prop:"operName"},{default:l(()=>[e(L,{modelValue:o.operName,"onUpdate:modelValue":t[1]||(t[1]=a=>o.operName=a),placeholder:"请输入操作人员",clearable:"",onKeyup:U(m,["enter"])},null,8,["modelValue"])]),_:1}),e(d,{label:"状态",prop:"status"},{default:l(()=>[e(Q,{modelValue:o.status,"onUpdate:modelValue":t[2]||(t[2]=a=>o.status=a),placeholder:"操作状态",clearable:"",style:{width:"120px"}},{default:l(()=>[e(D,{label:"正常",value:0}),e(D,{label:"异常",value:1})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:l(()=>[e(f,{type:"primary",icon:"Search",onClick:m},{default:l(()=>[...t[7]||(t[7]=[n("搜索",-1)])]),_:1}),e(f,{icon:"Refresh",onClick:O},{default:l(()=>[...t[8]||(t[8]=[n("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),b("div",ne,[e(f,{type:"danger",plain:"",icon:"Delete",disabled:v.value.length===0,onClick:K},{default:l(()=>[...t[9]||(t[9]=[n(" 删除 ",-1)])]),_:1},8,["disabled"]),e(f,{type:"danger",icon:"Delete",onClick:P},{default:l(()=>[...t[10]||(t[10]=[n(" 清空 ",-1)])]),_:1})])]),b("div",se,[Z((c(),V(R,{data:z.value,border:"",onSelectionChange:T},{default:l(()=>[e(u,{type:"selection",width:"55",align:"center"}),e(u,{label:"日志编号",align:"center",prop:"oper_id",width:"80"}),e(u,{label:"系统模块",align:"center",prop:"title"}),e(u,{label:"业务类型",align:"center",prop:"business_type"},{default:l(a=>[e(C,{type:S(a.row.business_type).type},{default:l(()=>[n(p(S(a.row.business_type).label),1)]),_:2},1032,["type"])]),_:1}),e(u,{label:"请求方式",align:"center",prop:"request_method"}),e(u,{label:"操作人员",align:"center",prop:"oper_name"}),e(u,{label:"操作IP",align:"center",prop:"oper_ip",width:"130"}),e(u,{label:"操作状态",align:"center",prop:"status"},{default:l(a=>[a.row.status===0?(c(),V(C,{key:0,type:"success"},{default:l(()=>[...t[11]||(t[11]=[n("成功",-1)])]),_:1})):(c(),V(C,{key:1,type:"danger"},{default:l(()=>[...t[12]||(t[12]=[n("失败",-1)])]),_:1}))]),_:1}),e(u,{label:"操作日期",align:"center",prop:"oper_time",width:"180"},{default:l(a=>[n(p(M(a.row.oper_time)),1)]),_:1}),e(u,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:l(a=>[e(f,{link:"",type:"primary",icon:"View",onClick:ce=>I(a.row)},{default:l(()=>[...t[13]||(t[13]=[n("详细",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[G,h.value]]),b("div",re,[e($,{"current-page":o.pageNum,"onUpdate:currentPage":t[3]||(t[3]=a=>o.pageNum=a),"page-size":o.pageSize,"onUpdate:pageSize":t[4]||(t[4]=a=>o.pageSize=a),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:N.value,onSizeChange:m,onCurrentChange:m},null,8,["current-page","page-size","total"])])]),e(F,{title:"操作日志详情",modelValue:y.value,"onUpdate:modelValue":t[6]||(t[6]=a=>y.value=a),width:"700px","append-to-body":""},{footer:l(()=>[e(f,{onClick:t[5]||(t[5]=a=>y.value=!1)},{default:l(()=>[...t[14]||(t[14]=[n("关 闭",-1)])]),_:1})]),default:l(()=>[e(B,{model:r.value,"label-width":"100px"},{default:l(()=>[e(A,null,{default:l(()=>[e(_,{span:12},{default:l(()=>[e(d,{label:"操作模块："},{default:l(()=>[n(p(r.value.title),1)]),_:1}),e(d,{label:"登录信息："},{default:l(()=>[n(p(r.value.oper_name)+" / "+p(r.value.oper_ip),1)]),_:1})]),_:1}),e(_,{span:12},{default:l(()=>[e(d,{label:"请求地址："},{default:l(()=>[n(p(r.value.oper_url),1)]),_:1}),e(d,{label:"请求方式："},{default:l(()=>[n(p(r.value.request_method),1)]),_:1})]),_:1}),e(_,{span:24},{default:l(()=>[e(d,{label:"操作方法："},{default:l(()=>[n(p(r.value.method),1)]),_:1})]),_:1}),e(_,{span:24},{default:l(()=>[e(d,{label:"请求参数："},{default:l(()=>[b("div",de,p(r.value.oper_param),1)]),_:1})]),_:1}),e(_,{span:24},{default:l(()=>[e(d,{label:"返回参数："},{default:l(()=>[b("div",ie,p(r.value.json_result),1)]),_:1})]),_:1}),e(_,{span:24},{default:l(()=>[e(d,{label:"状态："},{default:l(()=>[r.value.status===0?(c(),k("div",pe,"正常")):(c(),k("div",ue,"失败"))]),_:1})]),_:1}),r.value.status===1?(c(),V(_,{key:0,span:24},{default:l(()=>[e(d,{label:"异常信息："},{default:l(()=>[n(p(r.value.error_msg),1)]),_:1})]),_:1})):ee("",!0)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),fe=le(_e,[["__scopeId","data-v-f8677563"]]);export{fe as default};
